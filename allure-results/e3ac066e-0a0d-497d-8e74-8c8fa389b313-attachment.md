# Test info

- Name: Download, edit, and upload Excel file from TeamLease
- Location: /home/ashok/Desktop/amazon-playwright-js/tests/downloadEditUpload.spec.js:6:5

# Error details

```
Error: locator.click: Test timeout of 60000ms exceeded.
Call log:
  - waiting for getByRole('button', { name: 'Client' })

    at /home/ashok/Desktop/amazon-playwright-js/tests/downloadEditUpload.spec.js:17:54
```

# Page snapshot

```yaml
- button "expand":
  - img "expand"
- img "Logo"
- list:
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
- text: Associate Onboarding
- img "search"
- textbox "Search"
- img "menu"
- img "menu"
- img "menu"
- img "menu"
- text: T
- paragraph: Hiring
- img "right-arrow"
- paragraph: Associate Onboarding
- button "open user manual User Manual":
  - img "open user manual"
  - text: User Manual
- button "Download Master data"
- button "Preview OL Template"
- button "+ Add Candidate"
- paragraph: AAM AADMI PARTY / A2FDL
- text: "10"
- button "OLStandardTemplateEDIT_A2FDL__4__edit_1747116964463"
- img "open"
- text: Pending 0 Success 1 Failed 0
- button "refresh summary":
  - img "refresh summary"
- button "delete sheet":
  - img "delete sheet"
- tablist:
  - tab "Active" [selected]
  - tab "Cancelled"
- img "Download master data"
- img "Bulk Upload"
- img "search"
- img "filter"
- table:
  - rowgroup:
    - row "Select all rows S.no. E-Code/RFID Employee Name Email ID Aadhar Number Type Expected DOJ Onboarding Status Offer Letter Action":
      - cell "Select all rows":
        - checkbox "Select all rows"
      - cell "S.no.":
        - paragraph: S.no.
      - cell "E-Code/RFID":
        - paragraph: E-Code/RFID
      - cell "Employee Name":
        - paragraph: Employee Name
      - cell "Email ID":
        - paragraph: Email ID
      - cell "Aadhar Number":
        - paragraph: Aadhar Number
      - cell "Type":
        - paragraph: Type
      - cell "Expected DOJ":
        - paragraph: Expected DOJ
      - cell "Onboarding Status":
        - paragraph: Onboarding Status
      - cell "Offer Letter":
        - paragraph: Offer Letter
      - cell "Action":
        - paragraph: Action
  - rowgroup:
    - row "Select row 1 7F0ZJReKu Netap netapQ@gmail.com ********9234 manual 16 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "1":
        - paragraph: "1"
      - cell "7F0ZJReKu":
        - paragraph: 7F0ZJReKu
      - cell "Netap":
        - paragraph: Netap
      - cell "netapQ@gmail.com":
        - paragraph: netapQ@gmail.com
      - cell "********9234":
        - paragraph: "********9234"
      - cell "manual":
        - paragraph: manual
      - cell "16 May 2025":
        - paragraph: 16 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 2 - aaaaa - ********9900 manual - Contact Information Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "2":
        - paragraph: "2"
      - cell "-":
        - paragraph: "-"
      - cell "aaaaa":
        - paragraph: aaaaa
      - cell "-":
        - paragraph: "-"
      - cell "********9900":
        - paragraph: "********9900"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Contact Information Pending":
        - paragraph: Contact Information Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 3 lwXoknbV ttt ttt@test.com ********3268 manual 15 May 2025 OL Generated":
      - cell "Select row":
        - checkbox "Select row"
      - cell "3":
        - paragraph: "3"
      - cell "lwXoknbV":
        - paragraph: lwXoknbV
      - cell "ttt":
        - paragraph: ttt
      - cell "ttt@test.com":
        - paragraph: ttt@test.com
      - cell "********3268":
        - paragraph: "********3268"
      - cell "manual":
        - paragraph: manual
      - cell "15 May 2025":
        - paragraph: 15 May 2025
      - cell "OL Generated":
        - paragraph: OL Generated
      - cell:
        - button:
          - img
      - cell:
        - img
    - row "Select row 4 O5QxMTNJ6 ppppp gfd@test.com ********4466 manual 23 May 2025 QC Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "4":
        - paragraph: "4"
      - cell "O5QxMTNJ6":
        - paragraph: O5QxMTNJ6
      - cell "ppppp":
        - paragraph: ppppp
      - cell "gfd@test.com":
        - paragraph: gfd@test.com
      - cell "********4466":
        - paragraph: "********4466"
      - cell "manual":
        - paragraph: manual
      - cell "23 May 2025":
        - paragraph: 23 May 2025
      - cell "QC Pending":
        - paragraph: QC Pending
      - cell:
        - button:
          - img
      - cell:
        - img
    - row "Select row 5 8YO94yxy kkk kkk@test.com ********3429 manual 14 May 2025 QC Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "5":
        - paragraph: "5"
      - cell "8YO94yxy":
        - paragraph: 8YO94yxy
      - cell "kkk":
        - paragraph: kkk
      - cell "kkk@test.com":
        - paragraph: kkk@test.com
      - cell "********3429":
        - paragraph: "********3429"
      - cell "manual":
        - paragraph: manual
      - cell "14 May 2025":
        - paragraph: 14 May 2025
      - cell "QC Pending":
        - paragraph: QC Pending
      - cell:
        - button:
          - img
      - cell:
        - img
    - row "Select row 6 - Bode Shania_Beahan@yahoo.com ********4644 manual 10 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "6":
        - paragraph: "6"
      - cell "-":
        - paragraph: "-"
      - cell "Bode":
        - paragraph: Bode
      - cell "Shania_Beahan@yahoo.com":
        - paragraph: Shania_Beahan@yahoo.com
      - cell "********4644":
        - paragraph: "********4644"
      - cell "manual":
        - paragraph: manual
      - cell "10 May 2025":
        - paragraph: 10 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 7 q7KTLazX4z Jaydev jaydev@gmail.com ********9234 manual 02 May 2025 OL Generated":
      - cell "Select row":
        - checkbox "Select row"
      - cell "7":
        - paragraph: "7"
      - cell "q7KTLazX4z":
        - paragraph: q7KTLazX4z
      - cell "Jaydev":
        - paragraph: Jaydev
      - cell "jaydev@gmail.com":
        - paragraph: jaydev@gmail.com
      - cell "********9234":
        - paragraph: "********9234"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "OL Generated":
        - paragraph: OL Generated
      - cell:
        - button:
          - img
      - cell:
        - img
    - row "Select row 8 HutSq0Z5c New New13@hotmail.com ********1000 manual 30 Apr 2025 QC Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "8":
        - paragraph: "8"
      - cell "HutSq0Z5c":
        - paragraph: HutSq0Z5c
      - cell "New":
        - paragraph: New
      - cell "New13@hotmail.com":
        - paragraph: New13@hotmail.com
      - cell "********1000":
        - paragraph: "********1000"
      - cell "manual":
        - paragraph: manual
      - cell "30 Apr 2025":
        - paragraph: 30 Apr 2025
      - cell "QC Pending":
        - paragraph: QC Pending
      - cell:
        - button:
          - img
      - cell:
        - img
    - row "Select row 9 9yBZC1Lc New Name Automated netapp011@gmail.com ********9203 manual 20 Apr 2025 OL Generated":
      - cell "Select row":
        - checkbox "Select row"
      - cell "9":
        - paragraph: "9"
      - cell "9yBZC1Lc":
        - paragraph: 9yBZC1Lc
      - cell "New Name Automated":
        - paragraph: New Name Automated
      - cell "netapp011@gmail.com":
        - paragraph: netapp011@gmail.com
      - cell "********9203":
        - paragraph: "********9203"
      - cell "manual":
        - paragraph: manual
      - cell "20 Apr 2025":
        - paragraph: 20 Apr 2025
      - cell "OL Generated":
        - paragraph: OL Generated
      - cell:
        - button:
          - img
      - cell:
        - img
    - row "Select row 10 EVZLjSfekN Newtest NEWadded@gmail.com ********3332 manual 20 Apr 2025 Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "10":
        - paragraph: "10"
      - cell "EVZLjSfekN":
        - paragraph: EVZLjSfekN
      - cell "Newtest":
        - paragraph: Newtest
      - cell "NEWadded@gmail.com":
        - paragraph: NEWadded@gmail.com
      - cell "********3332":
        - paragraph: "********3332"
      - cell "manual":
        - paragraph: manual
      - cell "20 Apr 2025":
        - paragraph: 20 Apr 2025
      - cell "Educational Documents Pending":
        - paragraph: Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
- button [disabled]:
  - img
- button [disabled]:
  - img
- button "1"
- button [disabled]:
  - img
- button [disabled]:
  - img
- paragraph: "Show:"
- textbox "Pick value": 10 rows
- img
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 | import * as fs from 'fs';
   3 | import * as path from 'path';
   4 | import * as xlsx from 'xlsx';
   5 |
   6 | test('Download, edit, and upload Excel file from TeamLease', async ({ page, context }) => {
   7 |   const downloadPath = '/home/ashok/downloads'; // real Downloads folder
   8 |
   9 |   // Step 1: Login and navigate
  10 |   await page.goto('https://hcm-consumer-ui-qa.teamlease.com/associateOnboarding?mode=Clients_mode&client_id=A2FDL');
  11 |   await page.locator('#username').fill('T10533');
  12 |   await page.getByRole('button', { name: 'Continue' }).click();
  13 |   await page.locator('#password').fill('12345');
  14 |   await page.getByRole('button', { name: 'Login' }).click();
  15 |
  16 |   // Step 2: Navigate to download section and initiate download
> 17 |   await page.getByRole('button', { name: 'Client' }).click();
     |                                                      ^ Error: locator.click: Test timeout of 60000ms exceeded.
  18 |   await page.getByRole('textbox', { name: 'Search Client / ID' }).fill('afbch');
  19 |   await page.getByRole('option', { name: 'AGS CINEMAS PRIVATE LIMITED -' }).click();
  20 |   await page.getByRole('img', { name: 'Download master data' }).click();
  21 |   await page.getByText('Download Client MOL Edit Data').click();
  22 |   await page.getByRole('checkbox', { name: 'Name as Aadhar' }).check();
  23 |   await page.getByRole('checkbox', { name: 'Aadhar No' }).check();
  24 |
  25 |   // Capture the download
  26 |   const download = await Promise.all([
  27 |     page.waitForEvent('download'),
  28 |     page.getByRole('button', { name: 'Download XLSX' }).click(),
  29 |   ]).then(([download]) => download);
  30 |
  31 |   // Save the downloaded file to /home/ashok/downloads with known name
  32 |   const downloadedFilePath = path.join(downloadPath, download.suggestedFilename());
  33 |   await download.saveAs(downloadedFilePath);
  34 |
  35 |   // Step 3: Edit the Excel file (change C2 and E2)
  36 |   const workbook = xlsx.readFile(downloadedFilePath);
  37 |   const worksheet = workbook.Sheets[workbook.SheetNames[0]];
  38 |
  39 |   // Modify cells
  40 |   worksheet['C2'].v = 'New Name';
  41 |   worksheet['E2'].v = 'Y';
  42 |
  43 |   // Save it (overwrite same file or use new one)
  44 |   xlsx.writeFile(workbook, downloadedFilePath); // save back to same path
  45 |
  46 |   // Step 4: Upload the edited file
  47 |   await page.getByRole('img', { name: 'Bulk Upload' }).click();
  48 |   await page.getByText('Client MOL Edit Data').click();
  49 |   const fileUploadDialog = await page.getByRole('dialog', { name: 'Client MOL Edit Upload' });
  50 |   await fileUploadDialog.setInputFiles(downloadedFilePath);
  51 |   await page.getByTestId('upload-button').click();
  52 |
  53 |   // Step 5: Clean up file (optional)
  54 |   fs.unlinkSync(downloadedFilePath); // delete the file after upload
  55 | });
  56 |
```