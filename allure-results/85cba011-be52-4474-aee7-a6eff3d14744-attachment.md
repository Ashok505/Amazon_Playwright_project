# Test info

- Name: Download, edit, and upload Excel file
- Location: /home/ashok/Desktop/amazon-playwright-js/tests/downloadEditUpload.spec.js:6:5

# Error details

```
Error: locator.setInputFiles: Error: Node is not an HTMLInputElement
Call log:
  - waiting for getByRole('dialog', { name: 'Client MOL Edit Upload' })
    - locator resolved to <section role="dialog" tabindex="-1" aria-modal="true" data-modal-content="true" aria-describedby="mantine-i2f1uv26r-body" aria-labelledby="mantine-i2f1uv26r-title" class="m_fd1ab0aa m_54c44539 mantine-Modal-content m_1b7284a3 mantine-Paper-root">â€¦</section>

    at /home/ashok/Desktop/amazon-playwright-js/tests/downloadEditUpload.spec.js:52:3
```

# Page snapshot

```yaml
- button "expand":
  - img "expand"
- img "Logo"
- list:
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
- text: Associate Onboarding
- img "search"
- textbox "Search"
- img "menu"
- img "menu"
- img "menu"
- img "menu"
- text: T
- paragraph: Hiring
- img "right-arrow"
- paragraph: Associate Onboarding
- button "open user manual User Manual":
  - img "open user manual"
  - text: User Manual
- text: Mode
- button "Mode": Client
- img "open"
- text: Client
- button "Client": AGS CINEMAS PRIVATE LIMITED -MADURAVOYAL / AFBCH
- img "open"
- button "Download Master data"
- button "Preview OL Template"
- button "+ Add Candidate"
- paragraph: Employees
- text: "10"
- button "OL_Template_ACXCH__2__1746703564987"
- img "open"
- text: Pending 0 Success 0 Failed 1
- img "download failed"
- button "refresh summary":
  - img "refresh summary"
- button "delete sheet":
  - img "delete sheet"
- tablist:
  - tab "Active" [selected]
  - tab "Cancelled"
- img "Download master data"
- img "Bulk Upload"
- img "search"
- img "filter"
- table:
  - rowgroup:
    - row "Select all rows S.no. E-Code/RFID Employee Name Email ID Aadhar Number Type Expected DOJ Onboarding Status Offer Letter Action":
      - cell "Select all rows":
        - checkbox "Select all rows"
      - cell "S.no.":
        - paragraph: S.no.
      - cell "E-Code/RFID":
        - paragraph: E-Code/RFID
      - cell "Employee Name":
        - paragraph: Employee Name
      - cell "Email ID":
        - paragraph: Email ID
      - cell "Aadhar Number":
        - paragraph: Aadhar Number
      - cell "Type":
        - paragraph: Type
      - cell "Expected DOJ":
        - paragraph: Expected DOJ
      - cell "Onboarding Status":
        - paragraph: Onboarding Status
      - cell "Offer Letter":
        - paragraph: Offer Letter
      - cell "Action":
        - paragraph: Action
  - rowgroup:
    - row "Select row 1 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "1":
        - paragraph: "1"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 2 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "2":
        - paragraph: "2"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 3 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "3":
        - paragraph: "3"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 4 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "4":
        - paragraph: "4"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 5 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "5":
        - paragraph: "5"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 6 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "6":
        - paragraph: "6"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 7 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "7":
        - paragraph: "7"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 8 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "8":
        - paragraph: "8"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 9 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "9":
        - paragraph: "9"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 10 - - - - manual - Personal Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "10":
        - paragraph: "10"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "-":
        - paragraph: "-"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Personal Details Pending":
        - paragraph: Personal Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
- button [disabled]:
  - img
- button [disabled]:
  - img
- button "1"
- button "2"
- button "3"
- button "4"
- button "5"
- img
- button "8"
- button:
  - img
- button:
  - img
- paragraph: "Show:"
- textbox "Pick value": 10 rows
- img
- dialog "Client MOL Edit Upload":
  - banner:
    - heading "Client MOL Edit Upload" [level=2]
    - button:
      - img
  - img
  - paragraph: Drag and drop files to Upload
  - text: Select files
  - list
  - button "Cancel"
  - button "Upload" [disabled]
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 | import * as XLSX from 'xlsx';
   3 | import fs from 'fs';
   4 | import path from 'path';
   5 |
   6 | test('Download, edit, and upload Excel file', async ({ page, context }) => {
   7 |   // Step 1: Login and navigate
   8 |   await page.goto('https://hcm-auth-uat.teamlease.com:3035/realms/hiretech/protocol/openid-connect/auth?client_id=alcs-saas&redirect_uri=https%3A%2F%2Fhcm-consumer-ui-qa.teamlease.com%2FassociateOnboarding%3Fmode%3DClients_mode%26corp_id%3D%26client_id%3DAFBCH&state=b39e315b-c4a6-4e98-bcc5-8caf99a54ea7&response_mode=fragment&response_type=code&scope=openid&nonce=4c745e17-68dc-4009-a86b-83797d8240af&code_challenge=p31IQ7PMJmepprHNTO0UWjDEw3wY9NQ0jrxX1dGM8hc&code_challenge_method=S256');
   9 |   
  10 |   await page.locator('#username').click();
  11 |   await page.locator('#username').fill('T10533')
  12 |
  13 |   await page.getByRole('button', { name: 'Continue' }).click();
  14 |   await page.locator('#password').fill('12345');
  15 |   await page.getByRole('button', { name: 'Login' }).click();
  16 |
  17 |   // Step 2: Navigate to download section
  18 |   await page.getByRole('img', { name: 'Download master data' }).click();
  19 |   await page.getByText('Download Client MOL Edit Data').click();
  20 |   await page.getByRole('checkbox', { name: 'Name as Aadhar' }).check();
  21 |   await page.getByRole('checkbox', { name: 'Aadhar No' }).check();
  22 |
  23 |   // Step 3: Download the file
  24 |   const [download] = await Promise.all([
  25 |     page.waitForEvent('download'),
  26 |     page.getByRole('button', { name: 'Download XLSX' }).click()
  27 |   ]);
  28 |   const downloadPath = await download.path();
  29 |   const newFilePath = path.join(__dirname, 'modified_template.xlsx');
  30 |   fs.copyFileSync(downloadPath, newFilePath);
  31 |
  32 |   // Step 4: Read and modify the Excel file
  33 |   const workbook = XLSX.readFile(newFilePath);
  34 |   const sheetName = workbook.SheetNames[0];
  35 |   const worksheet = workbook.Sheets[sheetName];
  36 |   const jsonData = XLSX.utils.sheet_to_json(worksheet);
  37 |
  38 |   for (let i = 0; i < jsonData.length; i++) {
  39 |     jsonData[i]['Name as Aadhar'] = `User${i + 1}`;
  40 |     jsonData[i]['Aadhar No'] = `9${Math.floor(100000000000 + Math.random() * 900000000000)}`;
  41 |     jsonData[i]['Emergency Contact'] = `9${Math.floor(1000000000 + Math.random() * 9000000000)}`;
  42 |   }
  43 |
  44 |   const newWorksheet = XLSX.utils.json_to_sheet(jsonData);
  45 |   workbook.Sheets[sheetName] = newWorksheet;
  46 |   XLSX.writeFile(workbook, newFilePath);
  47 |
  48 |   // Step 5: Upload the modified file
  49 |   await page.getByRole('img', { name: 'Bulk Upload' }).click();
  50 |   await page.getByText('Client MOL Edit Data').click();
  51 |   await page.getByText('Select files').click();
> 52 |   await page.getByRole('dialog', { name: 'Client MOL Edit Upload' }).setInputFiles(newFilePath);
     |   ^ Error: locator.setInputFiles: Error: Node is not an HTMLInputElement
  53 |   await page.getByTestId('upload-button').click();
  54 | });
  55 |
```