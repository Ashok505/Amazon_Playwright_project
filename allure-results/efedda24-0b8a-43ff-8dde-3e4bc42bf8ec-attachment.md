# Test info

- Name: Download, edit, and upload Excel file
- Location: /home/ashok/Desktop/amazon-playwright-js/tests/downloadEditUpload.spec.js:6:1

# Error details

```
Error: locator.setInputFiles: Test timeout of 60000ms exceeded.
Call log:
  - waiting for locator('input[type="file"]')

    at /home/ashok/Desktop/amazon-playwright-js/tests/downloadEditUpload.spec.js:47:3
```

# Page snapshot

```yaml
- button "expand":
  - img "expand"
- img "Logo"
- list:
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
- text: Associate Onboarding
- img "search"
- textbox "Search"
- img "menu"
- img "menu"
- img "menu"
- img "menu"
- text: T
- paragraph: Hiring
- img "right-arrow"
- paragraph: Associate Onboarding
- button "open user manual User Manual":
  - img "open user manual"
  - text: User Manual
- text: Mode
- button "Mode": Client
- img "open"
- text: Client
- button "Client": AAM AADMI PARTY / A2FDL
- img "open"
- button "Download Master data"
- button "Preview OL Template"
- button "+ Add Candidate"
- paragraph: Employees
- text: "10"
- button "OLStandardTemplateEDIT_A2FDL_edit_1747053059344"
- img "open"
- text: Pending 0 Success 0 Failed 1
- img "download failed"
- button "refresh summary":
  - img "refresh summary"
- button "delete sheet":
  - img "delete sheet"
- tablist:
  - tab "Active" [selected]
  - tab "Cancelled"
- img "Download master data"
- img "Bulk Upload"
- img "search"
- img "filter"
- table:
  - rowgroup:
    - row "Select all rows S.no. E-Code/RFID Employee Name Email ID Aadhar Number Type Expected DOJ Onboarding Status Offer Letter Action":
      - cell "Select all rows":
        - checkbox "Select all rows"
      - cell "S.no.":
        - paragraph: S.no.
      - cell "E-Code/RFID":
        - paragraph: E-Code/RFID
      - cell "Employee Name":
        - paragraph: Employee Name
      - cell "Email ID":
        - paragraph: Email ID
      - cell "Aadhar Number":
        - paragraph: Aadhar Number
      - cell "Type":
        - paragraph: Type
      - cell "Expected DOJ":
        - paragraph: Expected DOJ
      - cell "Onboarding Status":
        - paragraph: Onboarding Status
      - cell "Offer Letter":
        - paragraph: Offer Letter
      - cell "Action":
        - paragraph: Action
  - rowgroup:
    - row "Select row 1 - Nikolaus Elena_Hane75@yahoo.com ********9376 manual 10 May 2025 Salary Information Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "1":
        - paragraph: "1"
      - cell "-":
        - paragraph: "-"
      - cell "Nikolaus":
        - paragraph: Nikolaus
      - cell "Elena_Hane75@yahoo.com":
        - paragraph: Elena_Hane75@yahoo.com
      - cell "********9376":
        - paragraph: "********9376"
      - cell "manual":
        - paragraph: manual
      - cell "10 May 2025":
        - paragraph: 10 May 2025
      - cell "Salary Information Pending":
        - paragraph: Salary Information Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 2 - Watsica Spencer_King@hotmail.com ********0137 manual 10 May 2025 Salary Information Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "2":
        - paragraph: "2"
      - cell "-":
        - paragraph: "-"
      - cell "Watsica":
        - paragraph: Watsica
      - cell "Spencer_King@hotmail.com":
        - paragraph: Spencer_King@hotmail.com
      - cell "********0137":
        - paragraph: "********0137"
      - cell "manual":
        - paragraph: manual
      - cell "10 May 2025":
        - paragraph: 10 May 2025
      - cell "Salary Information Pending":
        - paragraph: Salary Information Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 3 - Lakin Avis.Will27@gmail.com ********8552 manual 10 May 2025 Salary Information Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "3":
        - paragraph: "3"
      - cell "-":
        - paragraph: "-"
      - cell "Lakin":
        - paragraph: Lakin
      - cell "Avis.Will27@gmail.com":
        - paragraph: Avis.Will27@gmail.com
      - cell "********8552":
        - paragraph: "********8552"
      - cell "manual":
        - paragraph: manual
      - cell "10 May 2025":
        - paragraph: 10 May 2025
      - cell "Salary Information Pending":
        - paragraph: Salary Information Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 4 - Leffler Scottie.Crooks70@gmail.com ********5925 manual 10 May 2025 Salary Information Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "4":
        - paragraph: "4"
      - cell "-":
        - paragraph: "-"
      - cell "Leffler":
        - paragraph: Leffler
      - cell "Scottie.Crooks70@gmail.com":
        - paragraph: Scottie.Crooks70@gmail.com
      - cell "********5925":
        - paragraph: "********5925"
      - cell "manual":
        - paragraph: manual
      - cell "10 May 2025":
        - paragraph: 10 May 2025
      - cell "Salary Information Pending":
        - paragraph: Salary Information Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 5 - Ratke Shannon.Kunze@hotmail.com ********2308 manual 10 May 2025 Salary Information Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "5":
        - paragraph: "5"
      - cell "-":
        - paragraph: "-"
      - cell "Ratke":
        - paragraph: Ratke
      - cell "Shannon.Kunze@hotmail.com":
        - paragraph: Shannon.Kunze@hotmail.com
      - cell "********2308":
        - paragraph: "********2308"
      - cell "manual":
        - paragraph: manual
      - cell "10 May 2025":
        - paragraph: 10 May 2025
      - cell "Salary Information Pending":
        - paragraph: Salary Information Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 6 - Wunsch Zack_Hudson2@gmail.com ********3953 manual - Employment Details Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "6":
        - paragraph: "6"
      - cell "-":
        - paragraph: "-"
      - cell "Wunsch":
        - paragraph: Wunsch
      - cell "Zack_Hudson2@gmail.com":
        - paragraph: Zack_Hudson2@gmail.com
      - cell "********3953":
        - paragraph: "********3953"
      - cell "manual":
        - paragraph: manual
      - cell "-":
        - paragraph: "-"
      - cell "Employment Details Pending":
        - paragraph: Employment Details Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 7 wwTaojBCg Rohan three rohan05@gmail.com ********9122 manual 02 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "7":
        - paragraph: "7"
      - cell "wwTaojBCg":
        - paragraph: wwTaojBCg
      - cell "Rohan three":
        - paragraph: Rohan three
      - cell "rohan05@gmail.com":
        - paragraph: rohan05@gmail.com
      - cell "********9122":
        - paragraph: "********9122"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 8 QqNDZyd Rohan rohan02@gmail.com ********9111 manual 02 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "8":
        - paragraph: "8"
      - cell "QqNDZyd":
        - paragraph: QqNDZyd
      - cell "Rohan":
        - paragraph: Rohan
      - cell "rohan02@gmail.com":
        - paragraph: rohan02@gmail.com
      - cell "********9111":
        - paragraph: "********9111"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 9 NeScmpCL sfff ass@gmail.com ********6221 manual 12 May 2025 OL Generated":
      - cell "Select row":
        - checkbox "Select row"
      - cell "9":
        - paragraph: "9"
      - cell "NeScmpCL":
        - paragraph: NeScmpCL
      - cell "sfff":
        - paragraph: sfff
      - cell "ass@gmail.com":
        - paragraph: ass@gmail.com
      - cell "********6221":
        - paragraph: "********6221"
      - cell "manual":
        - paragraph: manual
      - cell "12 May 2025":
        - paragraph: 12 May 2025
      - cell "OL Generated":
        - paragraph: OL Generated
      - cell:
        - button:
          - img
      - cell:
        - img
    - row "Select row 10 - Netap netapQ@gmail.com ********9234 manual 16 May 2025 E-Code Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "10":
        - paragraph: "10"
      - cell "-":
        - paragraph: "-"
      - cell "Netap":
        - paragraph: Netap
      - cell "netapQ@gmail.com":
        - paragraph: netapQ@gmail.com
      - cell "********9234":
        - paragraph: "********9234"
      - cell "manual":
        - paragraph: manual
      - cell "16 May 2025":
        - paragraph: 16 May 2025
      - cell "E-Code Pending":
        - paragraph: E-Code Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
- button [disabled]:
  - img
- button [disabled]:
  - img
- button "1"
- button "2"
- button "3"
- button:
  - img
- button:
  - img
- paragraph: "Show:"
- textbox "Pick value": 10 rows
- img
```

# Test source

```ts
   1 | const fs = require('fs');
   2 | const path = require('path');
   3 | const xlsx = require('xlsx');
   4 | const { test, expect } = require('@playwright/test');
   5 |
   6 | test('Download, edit, and upload Excel file', async ({ page }) => {
   7 |   // Step 1: Login
   8 |   await page.goto('https://hcm-consumer-ui-qa.teamlease.com/associateOnboarding?mode=Clients_mode&client_id=AFBCH');
   9 |
  10 |   await page.locator('#username').fill('T10533');
  11 |   await page.getByRole('button', { name: 'Continue' }).click();
  12 |   await page.locator('#password').fill('12345');
  13 |   await page.getByRole('button', { name: 'Login' }).click();
  14 |
  15 |   await page.getByRole('button', { name: 'Client' }).click();
  16 |   await page.getByRole('option', { name: 'AAM AADMI PARTY / A2FDL' }).click();
  17 |
  18 |   // Step 2: Download Excel
  19 |   await page.getByRole('img', { name: 'Download master data' }).click();
  20 |   await page.getByText('Download Client MOL Edit Data').click();
  21 |   await page.getByRole('checkbox', { name: 'Name as Aadhar' }).check();
  22 |   await page.getByRole('checkbox', { name: 'Aadhar No' }).check();
  23 |
  24 |   const [download] = await Promise.all([
  25 |     page.waitForEvent('download'),
  26 |     page.getByRole('button', { name: 'Download XLSX' }).click()
  27 |   ]);
  28 |
  29 |   const downloadPath = path.join(__dirname, 'downloads', await download.suggestedFilename());
  30 |   await download.saveAs(downloadPath);
  31 |
  32 |
  33 |
  34 |
  35 |   // Step 3: Edit Excel File
  36 |   const workbook = xlsx.readFile(downloadPath);
  37 |   const sheetName = workbook.SheetNames[0];
  38 |   const worksheet = workbook.Sheets[sheetName];
  39 |
  40 |   worksheet['C2'] = worksheet['C2'] || { t: 's', v: '' };
  41 |   worksheet['C2'].v = 'Modified Name';
  42 |
  43 |   const editedFilePath = path.join(__dirname, 'downloads', 'edited_' + path.basename(downloadPath));
  44 |   xlsx.writeFile(workbook, editedFilePath);
  45 |
  46 |   const fileInputt = await page.locator('input[type="file"]'); // update selector if needed
> 47 |   await fileInputt.setInputFiles(editedFilePath);
     |   ^ Error: locator.setInputFiles: Test timeout of 60000ms exceeded.
  48 |
  49 |   await page.click('button:has-text("Upload")');
  50 |
  51 |
  52 | });
  53 |
```