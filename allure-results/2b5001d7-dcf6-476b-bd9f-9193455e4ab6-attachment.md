# Test info

- Name: Download, modify, and upload Excel file
- Location: /home/ashok/Desktop/amazon-playwright-js/tests/use.spec.js:6:5

# Error details

```
Error: locator.check: Error: strict mode violation: getByRole('checkbox', { name: 'Email ID' }) resolved to 3 elements:
    1) <input type="checkbox" id="mantine-no6eqpmj1" class="mantine-focus-auto m_26063560 mantine-Checkbox-input"/> aka getByRole('checkbox', { name: 'Email ID', exact: true })
    2) <input type="checkbox" id="mantine-8k1mimweq" class="mantine-focus-auto m_26063560 mantine-Checkbox-input"/> aka getByRole('checkbox', { name: 'RM Email id' })
    3) <input type="checkbox" id="mantine-kx0zu6r7x" class="mantine-focus-auto m_26063560 mantine-Checkbox-input"/> aka getByRole('checkbox', { name: 'Soft Copy OL Receiver Email Id' })

Call log:
  - waiting for getByRole('checkbox', { name: 'Email ID' })

    at /home/ashok/Desktop/amazon-playwright-js/tests/use.spec.js:39:56
```

# Page snapshot

```yaml
- button "expand":
  - img "expand"
- img "Logo"
- list:
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
  - listitem:
    - img "menu"
- text: Associate Onboarding
- img "search"
- textbox "Search"
- img "menu"
- img "menu"
- img "menu"
- img "menu"
- text: T
- paragraph: Hiring
- img "right-arrow"
- paragraph: Associate Onboarding
- button "open user manual User Manual":
  - img "open user manual"
  - text: User Manual
- button "Download Master data"
- button "Preview OL Template"
- button "+ Add Candidate"
- paragraph: AGS CINEMAS PRIVATE LIMITED -MADURAVOYAL / AFBCH
- text: "05"
- button "OLStandardTemplateEDIT_AFBCH_edit_1747214559999"
- img "open"
- text: Pending 0 Success 0 Failed 1
- img "download failed"
- button "refresh summary":
  - img "refresh summary"
- button "delete sheet":
  - img "delete sheet"
- tablist:
  - tab "Active" [selected]
  - tab "Cancelled"
- img "Download master data"
- img "Bulk Upload"
- img "search"
- img "filter"
- table:
  - rowgroup:
    - row "Select all rows S.no. E-Code/RFID Employee Name Email ID Aadhar Number Type Expected DOJ Onboarding Status Offer Letter Action":
      - cell "Select all rows":
        - checkbox "Select all rows"
      - cell "S.no.":
        - paragraph: S.no.
      - cell "E-Code/RFID":
        - paragraph: E-Code/RFID
      - cell "Employee Name":
        - paragraph: Employee Name
      - cell "Email ID":
        - paragraph: Email ID
      - cell "Aadhar Number":
        - paragraph: Aadhar Number
      - cell "Type":
        - paragraph: Type
      - cell "Expected DOJ":
        - paragraph: Expected DOJ
      - cell "Onboarding Status":
        - paragraph: Onboarding Status
      - cell "Offer Letter":
        - paragraph: Offer Letter
      - cell "Action":
        - paragraph: Action
  - rowgroup:
    - row "Select row 1 g03mR2I Richard tinashepherd@example.com ********1240 manual 02 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "1":
        - paragraph: "1"
      - cell "g03mR2I":
        - paragraph: g03mR2I
      - cell "Richard":
        - paragraph: Richard
      - cell "tinashepherd@example.com":
        - paragraph: tinashepherd@example.com
      - cell "********1240":
        - paragraph: "********1240"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 2 ll2WFCzUTu hello rohannn@gmail.com ********9875 manual 02 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "2":
        - paragraph: "2"
      - cell "ll2WFCzUTu":
        - paragraph: ll2WFCzUTu
      - cell "hello":
        - paragraph: hello
      - cell "rohannn@gmail.com":
        - paragraph: rohannn@gmail.com
      - cell "********9875":
        - paragraph: "********9875"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 3 iYTqtRS Shane steve80@example.net ********4388 manual 02 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "3":
        - paragraph: "3"
      - cell "iYTqtRS":
        - paragraph: iYTqtRS
      - cell "Shane":
        - paragraph: Shane
      - cell "steve80@example.net":
        - paragraph: steve80@example.net
      - cell "********4388":
        - paragraph: "********4388"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 4 Rmmvlb054z CarlosF abass@example.net ********3759 manual 02 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "4":
        - paragraph: "4"
      - cell "Rmmvlb054z":
        - paragraph: Rmmvlb054z
      - cell "CarlosF":
        - paragraph: CarlosF
      - cell "abass@example.net":
        - paragraph: abass@example.net
      - cell "********3759":
        - paragraph: "********3759"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
    - row "Select row 5 gHh3ZPr Nicholas miguelglass@example.org ********4292 manual 02 May 2025 Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
      - cell "Select row":
        - checkbox "Select row"
      - cell "5":
        - paragraph: "5"
      - cell "gHh3ZPr":
        - paragraph: gHh3ZPr
      - cell "Nicholas":
        - paragraph: Nicholas
      - cell "miguelglass@example.org":
        - paragraph: miguelglass@example.org
      - cell "********4292":
        - paragraph: "********4292"
      - cell "manual":
        - paragraph: manual
      - cell "02 May 2025":
        - paragraph: 02 May 2025
      - cell "Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending":
        - paragraph: Aadhar Card Front, Aadhar Card Back, PAN Card Documents, Bank Documents, Educational Documents Pending
      - cell:
        - button [disabled]:
          - img
      - cell:
        - img
- button [disabled]:
  - img
- button [disabled]:
  - img
- button "1"
- button [disabled]:
  - img
- button [disabled]:
  - img
- paragraph: "Show:"
- textbox "Pick value": 10 rows
- img
- dialog "Existing Fields in OL":
  - banner:
    - heading "Existing Fields in OL" [level=2]
    - button "close":
      - img
  - heading "Personal Details" [level=4]
  - checkbox "Name as Aadhar" [checked]
  - text: Name as Aadhar
  - checkbox "Gender"
  - text: Gender
  - checkbox "Date of Birth"
  - text: Date of Birth
  - checkbox "Father/Husband Name"
  - text: Father/Husband Name
  - checkbox "Relationship"
  - text: Relationship
  - checkbox "Marital Status"
  - text: Marital Status
  - checkbox "Is Handicapped (Y/N)"
  - text: Is Handicapped (Y/N)
  - heading "KYC Information" [level=4]
  - checkbox "Aadhar No" [checked]
  - text: Aadhar No
  - checkbox "PAN No" [checked]
  - text: PAN No
  - checkbox "Account Number" [checked]
  - text: Account Number
  - checkbox "IFSC Code"
  - text: IFSC Code
  - heading "Contact Information" [level=4]
  - checkbox "Mobile Number" [checked]
  - text: Mobile Number
  - checkbox "Email ID"
  - text: Email ID
  - checkbox "Permanent Address"
  - text: Permanent Address
  - checkbox "Permanent Pincode"
  - text: Permanent Pincode
  - checkbox "Present Address"
  - text: Present Address
  - checkbox "Present Pincode"
  - text: Present Pincode
  - checkbox "Emergency Contact No"
  - text: Emergency Contact No
  - heading "Educational Details" [level=4]
  - checkbox "Qualification"
  - text: Qualification
  - heading "Employment Details" [level=4]
  - checkbox "State"
  - text: State
  - checkbox "Industry Type"
  - text: Industry Type
  - checkbox "Job Location"
  - text: Job Location
  - checkbox "Zone"
  - text: Zone
  - checkbox "Job Category"
  - text: Job Category
  - checkbox "Contract From (DOJ)"
  - text: Contract From (DOJ)
  - checkbox "Contract End Date"
  - text: Contract End Date
  - checkbox "RM Email id"
  - text: RM Email id
  - checkbox "RM Name"
  - text: RM Name
  - checkbox "RM Contact Number"
  - text: RM Contact Number
  - checkbox "RM Ecode"
  - text: RM Ecode
  - checkbox "Interaction ID"
  - text: Interaction ID
  - heading "Salary Information" [level=4]
  - checkbox "Breakup ID"
  - text: Breakup ID
  - checkbox "Salary Type (CTC / Gross / Net)"
  - text: Salary Type (CTC / Gross / Net)
  - checkbox "Template ID"
  - text: Template ID
  - checkbox "Salary per Month"
  - text: Salary per Month
  - heading "Miscellaneous" [level=4]
  - checkbox "OL Email Trigger(Y/N)"
  - text: OL Email Trigger(Y/N)
  - checkbox "Soft Copy OL Receiver Name"
  - text: Soft Copy OL Receiver Name
  - checkbox "Soft Copy OL Receiver Email Id"
  - text: Soft Copy OL Receiver Email Id
  - button "Download XLSX"
  - button "Download CSV"
```

# Test source

```ts
   1 | import { test } from '@playwright/test';
   2 | import * as fs from 'fs';
   3 | import * as path from 'path';
   4 | import * as xlsx from 'xlsx';
   5 |
   6 | test('Download, modify, and upload Excel file', async ({ page }) => {
   7 |   const downloadPath = '/home/ashok/downloads';
   8 |
   9 |   // Random data generators
  10 |   const generateName = () => ['John', 'Alice', 'Ravi', 'Meena', 'Carlos', 'Nina', 'Sam', 'Asha']
  11 |     .sort(() => 0.5 - Math.random())[0] + String.fromCharCode(65 + Math.floor(Math.random() * 26));
  12 |
  13 |   const generateAadhar = () => Array.from({ length: 12 }, () => Math.floor(Math.random() * 10)).join('');
  14 |   const generatePAN = () => {
  15 |     const letters = () => String.fromCharCode(65 + Math.floor(Math.random() * 26));
  16 |     const digits = () => Math.floor(Math.random() * 10);
  17 |     return `${letters()}${letters()}${letters()}${letters()}${letters()}${digits()}${digits()}${digits()}${digits()}${letters()}`;
  18 |   };
  19 |   const generateAccount = () => Array.from({ length: 10 }, () => Math.floor(Math.random() * 10)).join('');
  20 |   const generateMobile = () => '9' + Array.from({ length: 9 }, () => Math.floor(Math.random() * 10)).join('');
  21 | const generateEmail = (name ) => `${name.toLowerCase()}${Math.floor(Math.random() * 100)}@example.com`;
  22 |
  23 |
  24 |   // Login
  25 |   await page.goto("https://hcm-consumer-ui-qa.teamlease.com/associateOnboarding?mode=Clients_mode&client_id=AFBCH");
  26 |   await page.fill('#username', 'T10533');
  27 |   await page.getByRole('button', { name: 'Continue' }).click();
  28 |   await page.fill('#password', '12345');
  29 |   await page.getByRole('button', { name: 'Login' }).click();
  30 |
  31 |   // Download Excel
  32 |   await page.getByRole('img', { name: 'Download master data' }).click();
  33 |   await page.getByText('Download Client MOL Edit Data').click();
  34 |   await page.getByRole('checkbox', { name: 'Name as Aadhar' }).check();
  35 |   await page.getByRole('checkbox', { name: 'Aadhar No' }).check();
  36 |   await page.getByRole('checkbox', {name: 'PAN No'}).check();
  37 |   await page.getByRole('checkbox', {name: 'Account Number'}).check();
  38 |   await page.getByRole('checkbox', {name: 'Mobile Number'}).check();
> 39 |   await page.getByRole('checkbox', {name: 'Email ID'}).check();
     |                                                        ^ Error: locator.check: Error: strict mode violation: getByRole('checkbox', { name: 'Email ID' }) resolved to 3 elements:
  40 |
  41 |   const [download] = await Promise.all([
  42 |     page.waitForEvent('download'),
  43 |     page.getByRole('button', { name: 'Download XLSX' }).click()
  44 |   ]);
  45 |   const file = path.join(downloadPath, download.suggestedFilename());
  46 |   await download.saveAs(file);
  47 |
  48 |   // Update Excel
  49 |   const workbook = xlsx.readFile(file);
  50 |   const sheet = workbook.Sheets[workbook.SheetNames[0]];
  51 |
  52 |   const name = generateName();
  53 |   const aadhar = generateAadhar();
  54 |   const pan = generatePAN();
  55 |   const account = generateAccount();
  56 |   const mobile = generateMobile();
  57 |   const email = generateEmail(name);
  58 |
  59 |   Object.assign(sheet, {
  60 |     C2: { t: 's', v: name },
  61 |     D2: { t: 's', v: aadhar },
  62 |     E2: { t: 's', v: pan },
  63 |     F2: { t: 's', v: account },
  64 |     G2: { t: 's', v: mobile },
  65 |     H2: { t: 's', v: email },
  66 |     I2: { t: 's', v: 'Y' },
  67 |     '!ref': sheet['!ref'] || 'A1:I2'
  68 |   });
  69 |
  70 |   xlsx.writeFile(workbook, file);
  71 |
  72 |   console.log('âœ… Excel updated with following data:');
  73 |   console.log(`Name (C2): ${name}`);
  74 |   console.log(`Aadhar (D2): ${aadhar}`);
  75 |   console.log(`PAN (E2): ${pan}`);
  76 |   console.log(`Account No (F2): ${account}`);
  77 |   console.log(`Mobile (G2): ${mobile}`);
  78 |   console.log(`Email (H2): ${email}`);
  79 |   console.log(`Status (I2): Y`);
  80 |
  81 |   // Upload updated file
  82 |   await page.getByRole('img', { name: 'Bulk Upload' }).click();
  83 |   await page.getByText('Client MOL Edit Data').click();
  84 |   await page.waitForTimeout(1000);
  85 |   await page.getByTestId('bulk_upload-input').setInputFiles(file);
  86 |   await page.getByTestId('upload-button').click();
  87 |   await page.waitForTimeout(8000);
  88 |
  89 |   fs.unlinkSync(file);
  90 | });
  91 |
```